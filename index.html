<!DOCTYPE html>
<html>
<head>
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@300&display=swap" rel="stylesheet">   
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Inconsolata:wght@300&display=swap');
    </style>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js">
    </script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js">
    </script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
.footer {
   position: fixed;
   left: 0;
   bottom: 0;
   width: 100%;
   text-align: center;
   background-color:#020f2b;	
}

* {
  box-sizing: border-box;
}
  
.menu {
  float: left;
  width: 20%;
  text-align: center;
}

.menu a {
  background-color: #F4EBD9;
  padding: 10px;
  margin-top: 10px;
  display: block;
  width: 100%;
  color: #020F2B;
}

.main {
  float: left;
  width: 60%;
  padding: 0 20px;
  height: 500;
  min-height: 100%;
  }

.right {
  float: left;
  width: 20%;
  padding: 15px;
  margin-top: 7px;
  text-align: center;
}
	
h1 {
  font-size: 1.5em;
}
	
@media only screen and (max-width: 620px) {
  /* For desktops: */
  .menu, .main, .right {
    width: 100%;
    }
  .QRcode {
  	visibility: hidden;
    float: right;
  	width: 60%;
  	padding: 20 20px;
    display: none;
  }
}

@media only screen and (min-width: 621px) {
  /* For mobile phones: */
  .here {
  	visibility: hidden;
    float: right;
  	width: 60%;
  	padding: 20 20px;
    display: none;
  }
}
	
a:link,a:visited {
    color: #020F2B;  
    }
    a:hover {
	background-color:#BEE7E8;
    } 
}
 
.model-viewer::part(default-ar-button) {
   transform: scale(3);
    }  

</style>
</head>
<body style="font-family:Inconsolata;color:#058ED9;background-color:#020f2b;">

<div style="background-color:#058ED9;color:#020f2b;padding:5px;text-align:center;">
  <h1>View NASA's Aqua Satellite in Augmented Reality</h1>
</div>

<div style="overflow:auto">
  <div class="menu">
    <a href="https://cpoulinn.github.io/AR-Demo/no-annotations">View without annotations</a>
    <a href="https://sketchfab.com/3d-models/aqua-satellite-wWmEeEeS71I2eX4PS281MUMK3B5">Original 3D model by NASA</a>
  </div>
  
  <div class="main">
    <model-viewer
    style="width: 100%; height: 380px; top: 0px;"
    data-name="Satellite_improved_text"
    src="files/biosphere5y.glb"
    ios-src="files/biosphere5y.usdz"
    ar    
    ar-modes="webxr"
    camera-controls    
    camera-orbit="80deg 80deg 2.5m"  
    auto-rotate
    loading="eager"
    ></model-viewer>
    <model-viewer id="animated" camera-controls touch-action="pan-y" src="../../shared-assets/models/sphere.glb" ar alt="A 3D model of a duck">
  <div class="controls">
    <p>Texture Type</p>
    <select id="type">
      <option value="lottie">Lottie</option>
      <option value="video">Video</option>
      <option value="canvas">Canvas</option>
    </select>
  </div>
</model-viewer>
<script type="module">
const modelViewerAnimated = document.querySelector("model-viewer#animated");

let videoTexture = null;
let canvasTexture = null;
let lottieTexture = null;

customElements.whenDefined('model-viewer').then(() => {
  videoTexture = modelViewerAnimated.createVideoTexture("files/biosphere_short.mp4");
});

function getCanvasTexture() {
  if(canvasTexture) return canvasTexture;
  canvasTexture = modelViewerAnimated.createCanvasTexture();
  const canvas = canvasTexture.source.element;
  canvas.width = 1600;
  canvas.height = 800;
  const ctx = canvas.getContext('2d');
  ctx.font = "250px sans-serif";
  ctx.fillStyle = "#aaa";
  ctx.fillText('Canvas 2D!', 0, 400);
  canvasTexture.source.update();
  return canvasTexture;
}

function getLottieTexture() {
  if(lottieTexture) return lottieTexture;
  lottieTexture = modelViewerAnimated.createLottieTexture("../../shared-assets/models/24017-lottie-logo-animation.json", 2);
  return lottieTexture;
}

modelViewerAnimated.addEventListener("load", async () => {

  const material = modelViewerAnimated.model.materials[0];
  const {baseColorTexture} = material.pbrMetallicRoughness;

  baseColorTexture.setTexture(await getLottieTexture());

  document.querySelector('#type').addEventListener('input', async (event) => {
    switch(event.target.value){
      case "video":
        baseColorTexture.setTexture(videoTexture);
        break;
      case "canvas":
        baseColorTexture.setTexture(getCanvasTexture());
        break;
      case "lottie":
        baseColorTexture.setTexture(await getLottieTexture());
        break;
    }
  });
});

</script>
  </div>
  

  <div class="right">
    
<div class="QRcode"><p><img src="files/frame.png" alt="QR Code" style="width:150px; float:none;" ></p><p style="color:#BEE7E8; font-size:1.5em;">SCAN ME</p><p>Use your phone for the augmented reality experience</p></div>
  </div>

<div class="here"><p style="text-align: right; padding-right: 50px;font-size: 1.25em; font-weight: 900;">Try me in AR â†‘</p></div>
  </div>
<div class="footer"><p style="font-size: .7em;">Carina Poulin 2022</p></div>

</body>
</html>
